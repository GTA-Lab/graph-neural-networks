
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Creating Node Representations with DeepWalk &#8212; GNNs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03-Deepwalk';</script>
    <link rel="icon" href="_static/fum-logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Biased Random Walks in Node2Vec" href="04-Node2Vec.html" />
    <link rel="prev" title="Introduction to Network Analysis with NetworkX" href="02-Introduction-to-NetworkX.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/fum-cs-logo.png" class="logo__image only-light" alt="GNNs - Home"/>
    <img src="_static/fum-cs-logo.png" class="logo__image only-dark pst-js-only" alt="GNNs - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-Workshop-Pathway.html">Workshop Pathway</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-Introduction-to-NetworkX.html">Introduction to Network Analysis with NetworkX</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Creating Node Representations with DeepWalk</a></li>







<li class="toctree-l1"><a class="reference internal" href="04-Node2Vec.html">Biased Random Walks in Node2Vec</a></li>



<li class="toctree-l1"><a class="reference internal" href="05-GNNs.html">Graph Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-GCNs.html">Graph Convolutional Networks</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/gta-lab/graph-neural-networks/blob/main/notebooks/03-Deepwalk.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/gta-lab/graph-neural-networks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/gta-lab/graph-neural-networks/issues/new?title=Issue%20on%20page%20%2F03-Deepwalk.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/03-Deepwalk.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating Node Representations with DeepWalk</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Creating Node Representations with DeepWalk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#node-embedding">Node Embedding</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk-and-skip-gram">DeepWalk and Skip-Gram</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walks">Random Walks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-gram">Skip-Gram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk">DeepWalk</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-gram-model-in-natural-language-processing">Skip-Gram Model in Natural Language Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cbow-and-skip-gram">CBOW and Skip-gram</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-word2vec-in-gensim-and-making-it-work">Getting started with Word2Vec in Gensim and making it work!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-practical-example-of-word-embedding">A practical example of word embedding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gensim-nltk">Gensim &amp; NLTK</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walk">Random walk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#karate-club-example">Karate Club Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifications-of-nodes-using-knn">Classifications of nodes using kNN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-walk"><strong>Deep Walk</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-using-deep-walk-embeddings">Classification using deep walk embeddings</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjacency-matrix">adjacency matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#node-degrees">Node Degrees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk-embeddings">Deepwalk embeddings</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-overall-framework-of-deepwalk">The overall framework of deepwalk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-node-embeddings-in-2-dimensions">Visualizing node embeddings in 2 dimensions</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="creating-node-representations-with-deepwalk">
<h1>Creating Node Representations with DeepWalk<a class="headerlink" href="#creating-node-representations-with-deepwalk" title="Link to this heading">#</a></h1>
<section id="node-embedding">
<h2>Node Embedding<a class="headerlink" href="#node-embedding" title="Link to this heading">#</a></h2>
<p>Re-visit a layer of a simple GNN figure mentioned in <a class="reference external" href="https://gta-lab.github.io/gnn-intro/">A Gentle Introduction to Graph Neural Networks</a>:</p>
<p><img alt="" src="_images/arch_gcn.40871750.png" /></p>
<p>A single layer of a simple GNN. A graph is the input, and each component (V,E,U) gets updated by a MLP to produce a new graph. Each function subscript indicates a separate function for a different graph attribute at the n-th layer of a GNN model.</p>
<p>The goal of node embedding is encoding nodes so that similarity in the embedding space (e.g., dot product) approximates similarity in the original network.</p>
<p>See:</p>
<ul>
<li><p><a class="reference external" href="https://fum-cs.github.io/fds/ADS/">Johnson–Lindenstrauss lemma, at Foundations of Data Science course of FUM</a>:</p>
<blockquote>
<div><p>The Johnson-Lindenstrauss lemma states that if the data points lie in a very high-dimensional space, then projecting such points on simple random directions preserves their pairwise distances.</p>
</div></blockquote>
</li>
<li><p>Weisfeiler Leman graph isomorphism test in <a class="reference external" href="https://arxiv.org/pdf/1810.00826">How Powerful are Graph Neural Networks?</a>,  ICLR 2019, by: Keyulu Xu, Weihua Hu, Jure Leskovec, Stefanie Jegelka</p>
<blockquote>
<div><p>The Weisfeiler-Lehman algorithm is a powerful method to refine node labels based on neighborhood information in graphs. It serves as a foundational concept for GNNs, guiding how these networks aggregate information from their neighbors to learn better node and graph representations.</p>
</div></blockquote>
</li>
</ul>
<!-- $\bm{v} \in \mathbb{R} \rightarrow \bm{z} \in \mathbb{R}^d$ --><p><img alt="" src="_images/Node-Embedding.png" /></p>
<p><img alt="" src="_images/walks-on-graphs-and-skip-gram.png" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="deepwalk-and-skip-gram">
<h1>DeepWalk and Skip-Gram<a class="headerlink" href="#deepwalk-and-skip-gram" title="Link to this heading">#</a></h1>
<section id="random-walks">
<h2>Random Walks<a class="headerlink" href="#random-walks" title="Link to this heading">#</a></h2>
<p>A random walk is a mathematical model that describes a path composed of a succession of random steps. In the context of graph theory, a random walk on a graph is a sequence of vertices where each vertex in the sequence is chosen randomly from the neighbors of the previous vertex.</p>
</section>
<section id="skip-gram">
<h2>Skip-Gram<a class="headerlink" href="#skip-gram" title="Link to this heading">#</a></h2>
<p>The skip-gram model is a popular technique in natural language processing (NLP) for learning word embeddings. It aims to learn a vector representation of each word in a corpus, such that the vectors of similar words are close to each other in the vector space. In the skip-gram model, the objective is to predict the context words (i.e., words that appear within a certain window size around a target word) given the target word.</p>
</section>
<section id="deepwalk">
<h2>DeepWalk<a class="headerlink" href="#deepwalk" title="Link to this heading">#</a></h2>
<p>DeepWalk is a graph embedding technique that uses random walks and the skip-gram model to learn low-dimensional representations of vertices in a graph. The key idea behind DeepWalk is to treat the sequences of vertices obtained from random walks on a graph as if they were sentences in a document, and then apply the skip-gram model to learn the vertex embeddings.</p>
<p>The DeepWalk algorithm consists of the following steps:</p>
<ol class="arabic simple">
<li><p><strong>Generate random walks</strong>: For each vertex in the graph, perform multiple random walks starting from that vertex. The length of each random walk is a hyperparameter.</p></li>
<li><p><strong>Apply skip-gram</strong>: Treat the sequences of vertices obtained from the random walks as “sentences” and apply the skip-gram model to learn the vertex embeddings. The objective is to predict the context vertices given a target vertex.</p></li>
<li><p><strong>Learn vertex embeddings</strong>: The skip-gram model learns a vector representation for each vertex in the graph, such that vertices that appear in similar contexts (i.e., have similar neighborhoods) have similar vector representations.</p></li>
</ol>
<p>The intuition behind DeepWalk is that vertices that are close in the graph (i.e., share many common neighbors) will tend to appear in similar contexts during the random walks, and thus will have similar vector representations learned by the skip-gram model.</p>
<p>By combining random walks and the skip-gram model, DeepWalk is able to learn low-dimensional, continuous representations of vertices that capture the structural information of the graph. These vertex embeddings can then be used as features for various graph-based tasks, such as node classification, link prediction, and graph visualization.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="skip-gram-model-in-natural-language-processing">
<h1>Skip-Gram Model in Natural Language Processing<a class="headerlink" href="#skip-gram-model-in-natural-language-processing" title="Link to this heading">#</a></h1>
<p>This following images depicts the concept of the <strong>skip-gram model</strong>, which is a popular technique in natural language processing (NLP) for learning word embeddings. The skip-gram model aims to learn a vector representation of each word in a corpus, such that the vectors of similar words are close to each other in the vector space.</p>
<p>The image shows the skip-gram model in the context of a sequence of words, where the objective is to predict the context words (i.e., words that appear within a certain window size around a target word) given the target word.</p>
<p>The central part of the image, labeled <span class="math notranslate nohighlight">\( f(x) \)</span>, represents the skip-gram model, which takes the current word <span class="math notranslate nohighlight">\( W_t \)</span> as input and tries to predict the surrounding context words, such as <span class="math notranslate nohighlight">\( W_{t-2} \)</span>, <span class="math notranslate nohighlight">\( W_{t-1} \)</span>, <span class="math notranslate nohighlight">\( W_{t+1} \)</span>, and <span class="math notranslate nohighlight">\( W_{t+2} \)</span>.</p>
<p>This process can be viewed as a Markov model, where the prediction of the context words depends only on the current word and not on the entire sequence of words. The probabilities of the context words, denoted as</p>
<div class="math notranslate nohighlight">
\[
P(W_{t-2} | W_t), \quad P(W_{t-1} | W_t), \quad P(W_{t+1} | W_t), \quad P(W_{t+2} | W_t)
\]</div>
<p>are the outputs of the skip-gram model.</p>
<p>By training the skip-gram model on a large corpus of text, the model learns to capture the semantic and syntactic relationships between words, resulting in word embeddings that can be used as features for various NLP tasks, such as text classification, named entity recognition, and machine translation.</p>
<p><img alt="" src="_images/predict-words.jpeg" /></p>
<p>For more information about the role of Markov Model in the learning and language models, see <a class="reference external" href="https://fum-cs.github.io/machine-learning/">Machine Learning section of Learning Theory Course at FUM</a>.</p>
<section id="cbow-and-skip-gram">
<h2>CBOW and Skip-gram<a class="headerlink" href="#cbow-and-skip-gram" title="Link to this heading">#</a></h2>
<p><img alt="" src="_images/The-CBOW-and-Skip-gram-architecture-of-word2vec.jpg" /></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="getting-started-with-word2vec-in-gensim-and-making-it-work">
<h1>Getting started with Word2Vec in Gensim and making it work!<a class="headerlink" href="#getting-started-with-word2vec-in-gensim-and-making-it-work" title="Link to this heading">#</a></h1>
<p>The idea behind Word2Vec is pretty simple. We are making and assumption that you can tell the meaning of a word by the company it keeps. This is analogous to the saying <em>show me your friends, and I’ll tell who you are</em>. So if you have two words that have very similar neighbors (i.e. the usage context is about the same), then these words are probably quite similar in meaning or are at least highly related.</p>
<p>In the following, you will learn how to use the Gensim implementation of Word2Vec and actually get it to work!</p>
<section id="a-practical-example-of-word-embedding">
<h2>A practical example of word embedding<a class="headerlink" href="#a-practical-example-of-word-embedding" title="Link to this heading">#</a></h2>
<p>Let’s start with a section of <em>Anne of Green Gables</em>:</p>
<blockquote>
<div><p>As much as she hated Gilbert, however, did she love Diana, with all the
love of her passionate little heart, equally intense in its likes and
dislikes. One evening Marilla, coming in from the orchard with a basket
of apples, found Anne sitting along by the east window in the twilight,
crying bitterly.
“Whatever’s the matter now, Anne?” she asked.
“It’s about Diana,” sobbed Anne luxuriously. “I love Diana so, Marilla.
I cannot ever live without her. But I know very well when we grow up
that Diana will get married and go away and leave me. And oh, what shall
I do? I hate her husband–I just hate him furiously. I’ve been imagining
it all out–the wedding and everything–Diana dressed in snowy garments,
with a veil, and looking as beautiful and regal as a queen; and me the
bridesmaid, with a lovely dress too, and puffed sleeves, but with a
breaking heart hid beneath my smiling face. And then bidding Diana
goodbye-e-e–” Here Anne broke down entirely and wept with increasing
bitterness.
Marilla turned quickly away to hide her twitching face; but it was no
use; she collapsed on the nearest chair and burst into such a hearty and
unusual peal of laughter that Matthew, crossing the yard outside, halted
in amazement. When had he heard Marilla laugh like that before?
“Well, Anne Shirley,” said Marilla as soon as she could speak, “if you
must borrow trouble, for pity’s sake borrow it handier home. I should
think you had an imagination, sure enough.”</p>
</div></blockquote>
<blockquote>
<div><p>— Lucy Maud Montgomery, <em>Anne of Green Gables</em></p>
</div></blockquote>
<p><img alt="" src="_images/Anne-Chapter-15-last-page.jpg" /></p>
</section>
<section id="gensim-nltk">
<h2>Gensim &amp; NLTK<a class="headerlink" href="#gensim-nltk" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Auto-setup when running on Google Colab</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/content/graph-neural-networks&#39;</span><span class="p">):</span>
    <span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>-q<span class="w"> </span>https://github.com/gta-lab/graph-neural-networks.git<span class="w"> </span>/content/graph-neural-networks
    <span class="o">%</span><span class="k">cd</span> graph-neural-networks/notebooks
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;As much as she hated Gilbert, however, did she love Diana, with all the</span>
<span class="s2">love of her passionate little heart, equally intense in its likes and</span>
<span class="s2">dislikes. One evening Marilla, coming in from the orchard with a basket</span>
<span class="s2">of apples, found Anne sitting along by the east window in the twilight,</span>
<span class="s2">crying bitterly.</span>
<span class="s2">“Whatever’s the matter now, Anne?” she asked.</span>
<span class="s2">“It’s about Diana,” sobbed Anne luxuriously. “I love Diana so, Marilla.</span>
<span class="s2">I cannot ever live without her. But I know very well when we grow up</span>
<span class="s2">that Diana will get married and go away and leave me. And oh, what shall</span>
<span class="s2">I do? I hate her husband--I just hate him furiously. I’ve been imagining</span>
<span class="s2">it all out--the wedding and everything--Diana dressed in snowy garments,</span>
<span class="s2">with a veil, and looking as beautiful and regal as a queen; and me the</span>
<span class="s2">bridesmaid, with a lovely dress too, and puffed sleeves, but with a</span>
<span class="s2">breaking heart hid beneath my smiling face. And then bidding Diana</span>
<span class="s2">goodbye-e-e--” Here Anne broke down entirely and wept with increasing</span>
<span class="s2">bitterness.</span>
<span class="s2">Marilla turned quickly away to hide her twitching face; but it was no</span>
<span class="s2">use; she collapsed on the nearest chair and burst into such a hearty and</span>
<span class="s2">unusual peal of laughter that Matthew, crossing the yard outside, halted</span>
<span class="s2">in amazement. When had he heard Marilla laugh like that before?</span>
<span class="s2">“Well, Anne Shirley,” said Marilla as soon as she could speak, “if you</span>
<span class="s2">must borrow trouble, for pity’s sake borrow it handier home. I should</span>
<span class="s2">think you had an imagination, sure enough.”</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.models.word2vec</span> <span class="kn">import</span> <span class="n">Word2Vec</span>

<span class="c1"># Create Word2Vec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">([</span><span class="n">text</span><span class="p">],</span>
                 <span class="n">sg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="c1"># Skip-gram</span>
                 <span class="n">vector_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">min_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># Train model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">([</span><span class="n">text</span><span class="p">],</span>  <span class="n">total_words</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="s2">&quot;Diana&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;her&#39;, 0.9902161359786987),
 (&#39;she&#39;, 0.9899694919586182),
 (&#39;wedding&#39;, 0.988711416721344),
 (&#39;should&#39;, 0.9884231686592102),
 (&#39;pity’s&#39;, 0.9849447011947632),
 (&#39;but&#39;, 0.9848229885101318),
 (&#39;east&#39;, 0.9828867316246033),
 (&#39;hate&#39;, 0.9828394055366516),
 (&#39;go&#39;, 0.9821310043334961),
 (&#39;like&#39;, 0.9820447564125061)]
</pre></div>
</div>
</div>
</div>
<p>Apply the model to the whole book of Anne of Green Gables</p>
<div class="cell tag_hide-input tag_hideCode tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  
<span class="kn">from</span> <span class="nn">gensim.models.word2vec</span> <span class="kn">import</span> <span class="n">Word2Vec</span>  
<span class="kn">import</span> <span class="nn">string</span> 
<span class="kn">import</span> <span class="nn">io</span>  
<span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>  
</pre></div>
</div>
</div>
</details>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     C:\Users\mamin\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fileName</span> <span class="o">=</span> <span class="s2">&quot;../data/Anne_of_Green_Gables.txt&quot;</span>  
<span class="n">file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>  
<span class="n">book_text</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  

<span class="n">text</span> <span class="o">=</span> <span class="n">book_text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="c1"># Remove stopwords  </span>
<span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))</span>  
<span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">if</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span><span class="p">]</span>  
<span class="c1"># Remove punctuation  </span>
<span class="n">translator</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">maketrans</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">+</span><span class="s2">&quot;”&quot;</span><span class="o">+</span><span class="s2">&quot;“&quot;</span><span class="p">)</span>  
<span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">translator</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">text</span><span class="p">]</span> 

<span class="c1"># Create Word2Vec  </span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">([</span><span class="n">text</span><span class="p">],</span>  
                 <span class="n">sg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="c1"># Skip-gram  </span>
                 <span class="n">vector_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>  
                 <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  
                 <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  
                 <span class="n">workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  
                 <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of W_embed: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  

<span class="c1"># Train model  </span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">([</span><span class="n">text</span><span class="p">],</span> <span class="n">total_words</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  

<span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="s2">&quot;Anne&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of W_embed: (8920, 50)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;Marilla&#39;, 0.8268883228302002),
 (&#39;said&#39;, 0.6982665657997131),
 (&#39;faltered&#39;, 0.610625684261322),
 (&#39;horrified&#39;, 0.6060405373573303),
 (&#39;astonishment&#39;, 0.6010062098503113),
 (&#39;spelled&#39;, 0.5995970964431763),
 (&#39;I&#39;, 0.5941324830055237),
 (&#39;fiddlesticks&#39;, 0.5927588939666748),
 (&#39;Oooh&#39;, 0.5925849080085754),
 (&#39;unsympathetic&#39;, 0.590878427028656)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="s2">&quot;Shirley&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;mother’s&#39;, 0.8844769597053528),
 (&#39;Yours&#39;, 0.8692860007286072),
 (&#39;owner&#39;, 0.8639934659004211),
 (&#39;father’s&#39;, 0.8601971864700317),
 (&#39;Walter&#39;, 0.8578155636787415),
 (&#39;remain&#39;, 0.8461606502532959),
 (&#39;Bertha&#39;, 0.8234245777130127),
 (&#39;respectfully&#39;, 0.817496120929718),
 (&#39;Will&#39;, 0.8153164386749268),
 (&#39;Call&#39;, 0.810065746307373)]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="random-walk">
<h1>Random walk<a class="headerlink" href="#random-walk" title="Link to this heading">#</a></h1>
<section id="karate-club-example">
<h2>Karate Club Example<a class="headerlink" href="#karate-club-example" title="Link to this heading">#</a></h2>
<p><img alt="" src="_images/karate_kid_raw_img.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Load dataset</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">karate_club_graph</span><span class="p">()</span>

<span class="c1"># Process labels (Mr. Hi = 0, Officer = 1)</span>
<span class="n">true_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s1">&#39;club&#39;</span><span class="p">]</span>
    <span class="n">true_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;Officer&#39;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of graph nodes:&quot;</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of graph edges:&quot;</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total number of graph nodes: 34
Total number of graph edges: 78
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot graph</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                 <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                 <span class="n">node_color</span><span class="o">=</span><span class="n">true_labels</span><span class="p">,</span>
                 <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                 <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                 <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
                 <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dd8733f4afa2c53273e4b486b3b50c2b2033727e869debeaef3a8c2208b01882.png" src="_images/dd8733f4afa2c53273e4b486b3b50c2b2033727e869debeaef3a8c2208b01882.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain features from the adjacency matrix (or use a different method for features)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Create masks to train and test the model</span>
<span class="n">train_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">test_mask</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">]</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_mask</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_mask</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">true_labels</span><span class="p">[</span><span class="n">train_mask</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">true_labels</span><span class="p">[</span><span class="n">test_mask</span><span class="p">]</span>
<span class="c1"># y_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 4. 5. ... 2. 0. 0.]
 [4. 0. 6. ... 0. 0. 0.]
 [5. 6. 0. ... 0. 2. 0.]
 ...
 [2. 0. 0. ... 0. 4. 4.]
 [0. 0. 2. ... 4. 0. 5.]
 [0. 0. 0. ... 4. 5. 0.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="classifications-of-nodes-using-knn">
<h2>Classifications of nodes using kNN<a class="headerlink" href="#classifications-of-nodes-using-knn" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>  
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>  
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  

<span class="c1"># Train Nearest Neighbors model  </span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">3</span>  
<span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>  
<span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  

<span class="c1"># Find nearest neighbors indices for X_test  </span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>  

<span class="c1"># Predict labels for test set based on nearest neighbors  </span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">))])</span>  

<span class="c1"># Evaluate accuracy  </span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy = </span><span class="si">{</span><span class="n">acc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy = 90.91%
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="k">def</span> <span class="nf">plot_graph_with_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">,</span> <span class="n">predicted_labels</span><span class="p">,</span> <span class="n">train_mask</span><span class="p">,</span> <span class="n">test_mask</span><span class="p">,</span> <span class="n">plot_title</span><span class="p">):</span>
    <span class="c1"># Initialize the colors for different classes</span>
    <span class="n">class_0_color_train</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>        <span class="c1"># Color for class 0 training nodes</span>
    <span class="n">class_1_color_train</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>         <span class="c1"># Color for class 1 training nodes</span>
    <span class="n">class_0_color_test</span> <span class="o">=</span> <span class="s1">&#39;lightblue&#39;</span>    <span class="c1"># Color for class 0 test nodes</span>
    <span class="n">class_1_color_test</span> <span class="o">=</span> <span class="s1">&#39;lightcoral&#39;</span>   <span class="c1"># Color for class 1 test nodes</span>
    <span class="n">misclassified_color</span> <span class="o">=</span> <span class="s1">&#39;darkgray&#39;</span>    <span class="c1"># Color for misclassified nodes</span>

    <span class="c1"># Prepare the color list for each node in the graph</span>
    <span class="n">node_colors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Iterate through all nodes in the graph</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">train_mask</span><span class="p">:</span>
            <span class="c1"># Current node is a training node</span>
            <span class="k">if</span> <span class="n">true_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_0_color_train</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_1_color_train</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">test_mask</span><span class="p">:</span>
            <span class="c1"># Current node is a testing node</span>
            <span class="n">test_index</span> <span class="o">=</span> <span class="n">test_mask</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">true_labels</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">predicted_labels</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Predicted class 1</span>
                    <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">misclassified_color</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_0_color_test</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">predicted_labels</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Predicted class 0</span>
                    <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">misclassified_color</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_1_color_test</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If the node is not in either mask, assign a default color (e.g., gray)</span>
            <span class="n">node_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

    <span class="c1"># Create a label dictionary</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()}</span>

    <span class="c1"># Plot the graph with labeled nodes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                     <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span>
                     <span class="n">node_color</span><span class="o">=</span><span class="n">node_colors</span><span class="p">,</span>  <span class="c1"># Use the color list</span>
                     <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                     <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>  <span class="c1"># Set font size for labels</span>
                     <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Draw labels</span>
                     <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>  <span class="c1"># Set font color for labels</span>
                     <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">plot_title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Example usage</span>
<span class="c1"># plot_graph_with_labels(G, true_labels, y_pred, train_mask, test_mask, &quot;Karate Club Graph Partitioned by kNN&quot;)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example usage  </span>
<span class="n">plot_graph_with_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">train_mask</span><span class="p">,</span> <span class="n">test_mask</span><span class="p">,</span> <span class="s2">&quot;Karate Club Graph Partitioned by kNN&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0ce6d9750e078415a74c441f9ea6fa345dfec144fc8d2fbc5d51e6bdc8eaf5f5.png" src="_images/0ce6d9750e078415a74c441f9ea6fa345dfec144fc8d2fbc5d51e6bdc8eaf5f5.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="deep-walk">
<h1><strong>Deep Walk</strong><a class="headerlink" href="#deep-walk" title="Link to this heading">#</a></h1>
<p>Now, we use random walks to generate node features as sentences in word embedding and then use word2vec for node embedding (Deep Walk).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">random_walk</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
    <span class="n">walk</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">start</span><span class="p">)]</span>  <span class="c1"># starting node</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">start</span><span class="p">)]</span>
        <span class="n">next_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">neighbors</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">walk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">next_node</span><span class="p">))</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">next_node</span>
    
    <span class="k">return</span> <span class="n">walk</span>

<span class="c1"># Create a list of random walks</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_walk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_walk</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;0&#39;, &#39;19&#39;, &#39;1&#39;, &#39;7&#39;]
[&#39;6&#39;, &#39;5&#39;, &#39;6&#39;, &#39;5&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list of random walks</span>
<span class="n">walks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">80</span><span class="p">):</span>
        <span class="n">walks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_walk</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Print the first random walk</span>
<span class="nb">print</span><span class="p">(</span><span class="n">walks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;0&#39;, &#39;3&#39;, &#39;2&#39;, &#39;32&#39;, &#39;22&#39;, &#39;33&#39;, &#39;14&#39;, &#39;33&#39;, &#39;31&#39;, &#39;28&#39;, &#39;31&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.models.word2vec</span> <span class="kn">import</span> <span class="n">Word2Vec</span> 
<span class="c1"># Create Word2Vec</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">(</span><span class="n">walks</span><span class="p">,</span>
                 <span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="c1"># Hierarchical softmax</span>
                 <span class="n">sg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>   <span class="c1"># Skip-gram</span>
                 <span class="n">vector_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                 <span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">workers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape of embedding matrix: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of embedding matrix: (34, 50)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build vocabulary</span>
<span class="n">model</span><span class="o">.</span><span class="n">build_vocab</span><span class="p">(</span><span class="n">walks</span><span class="p">)</span>

<span class="c1"># Train model</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">walks</span><span class="p">,</span> <span class="n">total_examples</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">corpus_count</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(187469, 897600)
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the model using Gensim&#39;s save method</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;word2vec_model.model&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Most similar nodes</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nodes that are the most similar to node 0:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">similarity</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">similarity</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Similarity between two nodes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Similarity between node 0 and 4: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">similarity</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Nodes that are the most similar to node 0:
   (&#39;10&#39;, 0.6763995885848999)
   (&#39;4&#39;, 0.6360117197036743)
   (&#39;17&#39;, 0.6139618754386902)
   (&#39;1&#39;, 0.5767839550971985)
   (&#39;6&#39;, 0.5750784277915955)
   (&#39;7&#39;, 0.5714203715324402)
   (&#39;5&#39;, 0.5569499731063843)
   (&#39;16&#39;, 0.5519386529922485)
   (&#39;11&#39;, 0.5395870804786682)
   (&#39;21&#39;, 0.5301610231399536)

Similarity between node 0 and 4: 0.6360117197036743
</pre></div>
</div>
</div>
</div>
<section id="classification-using-deep-walk-embeddings">
<h2>Classification using deep walk embeddings<a class="headerlink" href="#classification-using-deep-walk-embeddings" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>  
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>  

<span class="c1"># Extract embeddings from the Word2Vec model for the nodes in the train and test masks </span>
<span class="n">X_wv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
<span class="n">X_train_wv</span> <span class="o">=</span> <span class="n">X_wv</span><span class="p">[</span><span class="n">train_mask</span><span class="p">]</span>
<span class="n">X_test_wv</span> <span class="o">=</span>  <span class="n">X_wv</span><span class="p">[</span><span class="n">test_mask</span><span class="p">]</span>

<span class="c1"># Train Nearest Neighbors model  </span>
<span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">3</span>  
<span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>  
<span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_wv</span><span class="p">)</span>  

<span class="c1"># Find nearest neighbors indices for X_test  </span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X_test_wv</span><span class="p">)</span>  

<span class="c1"># Predict labels for test set based on nearest neighbors  </span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">))])</span>  

<span class="c1"># Evaluate accuracy  </span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy = </span><span class="si">{</span><span class="n">acc</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy = 95.45%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_graph_with_labels</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">true_labels</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">train_mask</span><span class="p">,</span> <span class="n">test_mask</span><span class="p">,</span> <span class="s1">&#39;DeepWalk + kNN &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e4747c04a601f94aaae08e2098ef5f599ae9c6e24e75cd91b2ef56bdd3b35716.png" src="_images/e4747c04a601f94aaae08e2098ef5f599ae9c6e24e75cd91b2ef56bdd3b35716.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.06,  0.17,  0.06,  0.04,  0.05, -0.06,  0.04,  0.08, -0.32,
        0.18, -0.01, -0.01,  0.24,  0.04,  0.14,  0.01,  0.15,  0.52,
       -0.45, -0.13,  0.12,  0.07,  0.13, -0.3 ,  0.05, -0.08,  0.27,
        0.09, -0.27, -0.06, -0.39, -0.4 ,  0.29, -0.29, -0.04, -0.04,
        0.37, -0.13, -0.12,  0.04, -0.22,  0.13, -0.1 ,  0.31,  0.23,
        0.1 , -0.09,  0.04,  0.09,  0.26], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># from sklearn.ensemble import RandomForestClassifier</span>
<span class="c1"># from sklearn.metrics import accuracy_score</span>

<span class="c1"># # Train classifier</span>
<span class="c1"># clf = RandomForestClassifier(random_state=0)</span>
<span class="c1"># clf.fit(X_train, y_train)</span>

<span class="c1"># # Evaluate accuracy</span>
<span class="c1"># y_pred = clf.predict(X_test)</span>
<span class="c1"># acc = accuracy_score(y_test, y_pred)</span>
<span class="c1"># print(f&#39;Accuracy (w/o embeddings) = {acc*100:.2f}%&#39;)</span>

<span class="c1"># clf.fit(X_train_emb, y_train)</span>
<span class="c1"># y_pred = clf.predict(X_test_emb)</span>
<span class="c1"># acc_emb = accuracy_score(y_test, y_pred)</span>

<span class="c1"># print(f&#39;Accuracy (w/o embeddings) = {acc_emb*100:.2f}%&#39;)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="clustering">
<h1>Clustering<a class="headerlink" href="#clustering" title="Link to this heading">#</a></h1>
<section id="adjacency-matrix">
<h2>adjacency matrix<a class="headerlink" href="#adjacency-matrix" title="Link to this heading">#</a></h2>
<p>The adjacency matrix is used as the features’ matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>  

<span class="c1"># Obtain features from the adjacency matrix (or use a different method for features)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Apply k-means clustering (let&#39;s choose 2 clusters for the Karate club graph)</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Plot graph with clusters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                 <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                 <span class="n">node_color</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                 <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                 <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                 <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
                 <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;K-Means Clustering of the Karate Club Graph, using adjacency matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 4. 5. ... 2. 0. 0.]
 [4. 0. 6. ... 0. 0. 0.]
 [5. 6. 0. ... 0. 2. 0.]
 ...
 [2. 0. 0. ... 0. 4. 4.]
 [0. 0. 2. ... 4. 0. 5.]
 [0. 0. 0. ... 4. 5. 0.]]
</pre></div>
</div>
<img alt="_images/59e38af373d98af96d47dc27f152d79db84f69df54adb5f8286d701ff5e1bf55.png" src="_images/59e38af373d98af96d47dc27f152d79db84f69df54adb5f8286d701ff5e1bf55.png" />
</div>
</div>
</section>
<section id="node-degrees">
<h2>Node Degrees<a class="headerlink" href="#node-degrees" title="Link to this heading">#</a></h2>
<p>Clustering the nodes with k-means. The node degrees are used as the node features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="c1"># Extract node features (node degrees)  </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">dict</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())[</span><span class="n">node</span><span class="p">]</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># Apply K-means clustering  </span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of clusters  </span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  

<span class="c1"># Plot graph with clusters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                 <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                 <span class="n">node_color</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                 <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                 <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                 <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
                 <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;K-Means Clustering of the Karate Club Graph, using node degrees&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[16  9 10  6  3  4  4  4  5  2  3  1  2  5  2  2  2  2  2  3  2  2  2  5
  3  3  2  4  3  4  4  6 12 17]
</pre></div>
</div>
<img alt="_images/29f6702dbac3e339a7d4dde0b121036c61100333ab807c5d03b7f485859d92cc.png" src="_images/29f6702dbac3e339a7d4dde0b121036c61100333ab807c5d03b7f485859d92cc.png" />
</div>
</div>
</section>
<section id="deepwalk-embeddings">
<h2>Deepwalk embeddings<a class="headerlink" href="#deepwalk-embeddings" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>

<span class="c1"># Apply K-means clustering  </span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of clusters  </span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_wv</span><span class="p">)</span>  

<span class="c1"># Plot graph with clusters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                 <span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                 <span class="n">node_color</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
                 <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span>
                 <span class="n">font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                 <span class="n">font_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span>
                 <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;K-Means Clustering of the Karate Club Graph, using node embeddings&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/904cf080d3d203f83e4e75b20ecb0b097f5e46621fd519881ffbf449854ad01d.png" src="_images/904cf080d3d203f83e4e75b20ecb0b097f5e46621fd519881ffbf449854ad01d.png" />
</div>
</div>
<blockquote>
<div><p><strong>Note that the above result was achieved without any node features!</strong></p>
</div></blockquote>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-overall-framework-of-deepwalk">
<h1>The overall framework of deepwalk<a class="headerlink" href="#the-overall-framework-of-deepwalk" title="Link to this heading">#</a></h1>
<p><img alt="" src="_images/Xu2020UnderstandingGE-rw_emb_pipeline2.png" /></p>
<p>Source: <a class="reference external" href="https://epubs.siam.org/doi/10.1137/20M1386062">Understanding Graph Embedding Methods and Their Applications</a>. By: M. Xu.</p>
<section id="visualizing-node-embeddings-in-2-dimensions">
<h2>Visualizing node embeddings in 2 dimensions<a class="headerlink" href="#visualizing-node-embeddings-in-2-dimensions" title="Link to this heading">#</a></h2>
<p>For an introduction to PCA, see the <a class="reference external" href="https://fum-cs.github.io/fds">Foundations of Data Science Course at FUM</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>

<span class="c1"># Preprocess word vectors and label</span>
<span class="c1"># nodes_wv = np.array([model.wv.get_vector(str(i)) for i in range(len(model.wv))])</span>
<span class="c1"># node_embeddings = np.array([model.wv[str(node)] for node in G.nodes])</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">true_labels</span><span class="p">)</span>

<span class="c1"># Train TSNE</span>
<span class="n">tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span>
            <span class="n">init</span><span class="o">=</span><span class="s1">&#39;pca&#39;</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_wv</span><span class="p">)</span>

<span class="c1"># Plot TSNE</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/99edc60abf008fb968e55128b62a10045980ac545d44edeca73a54a192c742bd.png" src="_images/99edc60abf008fb968e55128b62a10045980ac545d44edeca73a54a192c742bd.png" />
</div>
</div>
<p>For an introduction to K-means clustering, see the <a class="reference external" href="https://fum-cs.github.io/cs-bsc-dm/">Data Minig Course at FUM</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02-Introduction-to-NetworkX.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to Network Analysis with NetworkX</p>
      </div>
    </a>
    <a class="right-next"
       href="04-Node2Vec.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Biased Random Walks in Node2Vec</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Creating Node Representations with DeepWalk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#node-embedding">Node Embedding</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk-and-skip-gram">DeepWalk and Skip-Gram</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walks">Random Walks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-gram">Skip-Gram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk">DeepWalk</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#skip-gram-model-in-natural-language-processing">Skip-Gram Model in Natural Language Processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cbow-and-skip-gram">CBOW and Skip-gram</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-word2vec-in-gensim-and-making-it-work">Getting started with Word2Vec in Gensim and making it work!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-practical-example-of-word-embedding">A practical example of word embedding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gensim-nltk">Gensim &amp; NLTK</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#random-walk">Random walk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#karate-club-example">Karate Club Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifications-of-nodes-using-knn">Classifications of nodes using kNN</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deep-walk"><strong>Deep Walk</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-using-deep-walk-embeddings">Classification using deep walk embeddings</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering">Clustering</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adjacency-matrix">adjacency matrix</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#node-degrees">Node Degrees</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deepwalk-embeddings">Deepwalk embeddings</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#the-overall-framework-of-deepwalk">The overall framework of deepwalk</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-node-embeddings-in-2-dimensions">Visualizing node embeddings in 2 dimensions</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mahmood Amintoosi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024. CC0 Licensed - Computer Science Dept., Ferdowsi University of Mashhad.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>